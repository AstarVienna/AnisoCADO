 <!-- The paper should be between 250-1000 words -->

---
title: 'AnisoCADO - a python package for analytically generating adaptive optics point spread functions for the Extremely Large Telescope'

tags:
  - Python
  - astronomy
  - simulations
  - point spread functions
  - Extreme Large Telescope
  
authors:
  - name: Kieran Leschinski
    orcid: 0000-0003-0441-9784
    affiliation: 1
  - name: Eric Gendron
    affiliation: 2
    
affiliations:
 - name: Department of Astrophysics, University of Vienna
   index: 1
 - name: Institution 2
   index: 2
   
date: 19 May 2020

bibliography: paper.bib

---

# Statement of need
<!-- 
A clear Statement of Need that illustrates the research purpose of the software.
We also require that authors explain the research applications of the software. 
-->

Needs
- The PSF is a core component turning astronomical observations into data
- Three major new telescopes, all ELTS
- Tiny spatial scales that require AO correction
- AO corrections on segmented mirror cause artefacts
- AO correction is dependent on a wide range of atmospheric parameters
- Community needs to learn to deal with artefacts
- ELT as AO machine
- ELT will cost 300kâ‚¬ per night to run, so failed observations are not an option
- A package which makes such PSFs quickly and accessibly in python is extremely useful for educating community about how to deal with them
- Encourages early development of observation strategies and software tools for minimising the effect of these PSFs on science results

Research use cases
- in instrument simulators (ETC, science-grade simulators, pipeline raw data)
- science feasibility studies
- observation preparation
- data reduction and processing
- as ansatz for PSF-R techniques


# Summary
<!-- 
A summary describing the high-level functionality and purpose of the software for a diverse, non-specialist audience. 
For this reason, we require that authors include in the paper some sentences that explain the software functionality and domain of use to a non-specialist reader.

- where to find documentation
-->

- Background
    - What are PSFs, what is AO
    - What affects AO PSFs (wind profile, turbulence, atmospheric conditions, mirror structure, mirror surfaces, spiders)
    - PSFs were simple before AO. Given the importance of PSFs in turning raw data into results, it is imperative to correctly model PSFs.
    - PSFs are normally generated by ray tracing programs that track the mirror deformations over a certain time frame
    
- Purpose of software
    - To produce (SC)AO PSFs for the ELT, for a wide range of atmospheric condition, guide-star positions, mirror reflectivities, and observation settings 
        
- High level functionality
    - While the sole purpose of the package is to produce PSFs, there are many parameters which affect the output. 
    - Default is set to what an average science case will need
    - Large parameter space is provided to fine tune the PSFs for a given use case.
    - The picture shows the strong variation in PSFs for difference conditions 
    
    - Parameter space covered by AnisoCADO 
        - Set observation conditions
            - Guide star position
            - Zenith distance
            - Seeing
            - Wind (turbulence) profile
        - Set telescope characteristics 
            - Type of AO correction
            - Telescope pupil image
                - Missing segments
                - "Dirtyness" of segments
            - Actuator update frequency
            - Residual systematic wavefront error 
        - Additional Atmospheric parameters
            - Outer scale
            - Wind speed
            - 
        - Current use case is for SCAO
            - Can be extended to other forms of AO correction (e.g. MC, LT, GL)
        
    - Additional functions
        - get strehl ratio
        - make strehl maps
        - save psf in various output formats (np.array, FITS image/cube)


# References
<!--
A list of key references, including to other software addressing related needs.
-->

# Uses
<!--
Mention (if applicable) a representative set of past or ongoing research projects using the software and recent scholarly publications enabled by it.
-->

Projects using it
- ScopeSim
- SimCADO

Publications enabled by it 
- n/a

# Acknowledgements
<!--
Acknowledgement of any financial support.
-->

This research made use of Astropy, a community-developed core Python package for astronomy \citep{astropy, astropy2}. 
This research is partially funded by the project IS538003 of the Hochschulraumstrukturmittel (HRSM) provided by the Austrian Government and administered by the University of Vienna. The authors would also like to thank all the members of the consortium for their effort in the MICADO project, and their contributions to the development of this tool.